"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[7675],{5539:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>r,default:()=>u,frontMatter:()=>a,metadata:()=>l,toc:()=>d});var s=i(4848),t=i(8453);const a={},r="From Software Bugs to Security Vulnerabilities",l={id:"LLVM/CIS 547 Software Analysis/Module 1: Introduction to Software Analysis/reading_1",title:"From Software Bugs to Security Vulnerabilities",description:"- Software bugs cause damages:",source:"@site/docs/LLVM/CIS 547 Software Analysis/Module 1: Introduction to Software Analysis/1_reading_1.md",sourceDirName:"LLVM/CIS 547 Software Analysis/Module 1: Introduction to Software Analysis",slug:"/LLVM/CIS 547 Software Analysis/Module 1: Introduction to Software Analysis/reading_1",permalink:"/docs/LLVM/CIS 547 Software Analysis/Module 1: Introduction to Software Analysis/reading_1",draft:!1,unlisted:!1,editUrl:"https://github.com/syed-ahmed/syed-ahmed.github.io/blob/main/website/docs/LLVM/CIS 547 Software Analysis/Module 1: Introduction to Software Analysis/1_reading_1.md?plain=1",tags:[],version:"current",sidebarPosition:1,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Introduction to Software Analysis",permalink:"/docs/LLVM/CIS 547 Software Analysis/Module 1: Introduction to Software Analysis/intro"},next:{title:"Course VM and Lab Instructions",permalink:"/docs/LLVM/CIS 547 Software Analysis/Module 1: Introduction to Software Analysis/course_vm_lab"}},o={},d=[{value:"Case Study 1: OpenSSL Heatbleed Bug CVE-2014-0160",id:"case-study-1-openssl-heatbleed-bug-cve-2014-0160",level:2},{value:"Case Study 2: Apple&#39;s &quot;Goto Fail&quot; Bug CVE-2014-1266",id:"case-study-2-apples-goto-fail-bug-cve-2014-1266",level:2},{value:"Case Study 3: VLC Media Player Dependency Bug CVE-2019-13615",id:"case-study-3-vlc-media-player-dependency-bug-cve-2019-13615",level:2}];function c(e){const n={code:"code",h1:"h1",h2:"h2",li:"li",pre:"pre",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"from-software-bugs-to-security-vulnerabilities",children:"From Software Bugs to Security Vulnerabilities"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Software bugs cause damages:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Therac-25 radiation overdose."}),"\n",(0,s.jsx)(n.li,{children:"Ariane-5 rocket disaster."}),"\n",(0,s.jsx)(n.li,{children:"Northeastern blackout in 2003."}),"\n",(0,s.jsx)(n.li,{children:"Security vulnerablilities."}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:"Program analysis can prevent bugs."}),"\n",(0,s.jsxs)(n.li,{children:["Common Vulnerabilities and Exposures (CVE)","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Catalog security vulnerablilities."}),"\n",(0,s.jsx)(n.li,{children:"CVE ID number."}),"\n",(0,s.jsx)(n.li,{children:"Description."}),"\n",(0,s.jsx)(n.li,{children:"References."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"case-study-1-openssl-heatbleed-bug-cve-2014-0160",children:"Case Study 1: OpenSSL Heatbleed Bug CVE-2014-0160"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"OpenSSL used to secure communication over computer networks."}),"\n",(0,s.jsx)(n.li,{children:"Heartbleed eavesdropped on SSL/TLS encryption protocol."}),"\n",(0,s.jsx)(n.li,{children:'Bug in TLS "heartbeat extension", a protocol to check if server is alive.'}),"\n",(0,s.jsx)(n.li,{children:"Server sends back positive acknowledgement by returning copy of received data."}),"\n",(0,s.jsxs)(n.li,{children:["Code for processing incoming message:","\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-cpp",children:"hbtype = *p++;\nn2s(p, payload);        // write two bytes from \u2018p\u2019 into \u2018payload\u2019\npl = p;  // \u2018pl\u2019 now points to contents of payload\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Code for constructing reply:","\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-cpp",children:"*bp++ = TLS1_HB_RESPONSE;\nn2s(payload, bp);       // write two bytes from \u2018payload\u2019 into \u2018bp\u2019 \nmemcpy(bp, pl, payload) // copy \u2018payload\u2019 bytes from \u2018pl\u2019 to \u2018bp\u2019\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Send a message with small payload data but specify different longer length, ",(0,s.jsx)(n.code,{children:"memcpy"})," will\nread more data."]}),"\n",(0,s.jsxs)(n.li,{children:["Needs bounds-checking to prevent this:","\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-cpp",children:"hbtype = *p++;\nn2s(p, payload);\nif (1 + 2 + payload + 16 > ...) // \u201c...\u201d is received message\u2019s length\n\treturn 0;  // silently discard per RFC 6520 sec. 4\npl = p;\n"})}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:"Automatically discover using dynamic/static analysis."}),"\n",(0,s.jsx)(n.li,{children:"Dynamic approach: use LibFuzzer, Address Sanitizer. Fuzzer constructs abnormal inputs.\nSanitizer errors out memcpy."}),"\n",(0,s.jsx)(n.li,{children:"Static approach: use Coverity, information-flow/taint-tracking analysis."}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"case-study-2-apples-goto-fail-bug-cve-2014-1266",children:'Case Study 2: Apple\'s "Goto Fail" Bug CVE-2014-1266'}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Capture and modify data in sessions secured by SSL/TLS."}),"\n",(0,s.jsxs)(n.li,{children:["Bug in function that verifies SSL key exchange.","\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-cpp",children:"static OSStatus SSLVerifySignedServerKeyExchange( ... ) {\n...\nif ((err = SSLHashSHA1.update(&hashCtx, &signedParams)) != 0)\n\tgoto fail;\n\t// highlight-next-line\n\tgoto fail;\n...\nerr = sslRawVerify( ... );\n...\nfail:\n\tSSLFreeBuffer(&signedHashes);\n\tSSLFreeBuffer(&hashCtx);\n\treturn err;\n}\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Second ",(0,s.jsx)(n.code,{children:"goto fail"})," is unconditional."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"sslRawVerify"})," is bypassed."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"SSLVerifySignedServerKeyExchange"})," function returns successful even when it's not."]}),"\n",(0,s.jsx)(n.li,{children:"Attacker can do man-in-the-middle attack."}),"\n",(0,s.jsx)(n.li,{children:"Automatically detect bug using static analysis."}),"\n",(0,s.jsx)(n.li,{children:"Unreachable code analysis: can reveal portion of code unreachable after the second goto statement."}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"case-study-3-vlc-media-player-dependency-bug-cve-2019-13615",children:"Case Study 3: VLC Media Player Dependency Bug CVE-2019-13615"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Heap-based buffer over-read in EBML component that parses media types."}),"\n",(0,s.jsx)(n.li,{children:"Enabled remote code execution and access user's machine if user opened a malicious file."}),"\n",(0,s.jsxs)(n.li,{children:["Bug in:","\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-cpp",children:"EbmlElement* EbmlElement::FindNextElement( ... ) {\n...\ndo {\n\t...\n\tif (DataStream.read(&PossibleIdNSize[ReadIndex++], 1) == 0) {\n\t\treturn NULL;\n\t}\n\tReadSize++;\n\t...\nwhile (...);\n...\n}\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Bound-check missing before reading, attacker can read beyond bounds. Fix:","\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-cpp",children:"EbmlElement * EbmlElement::FindNextElement(...) {\n\t...\n\t// highlight-start\n\tif (MaxDataSize <= ReadSize)\n\t\tbreak;\n\t// highlight-end\n\tif (DataStream.read(&PossibleIdNSize[ReadIndex++], 1) == 0) {\n\t\treturn NULL;\n\t}\n\tReadSize++;\n\t...\n}\n"})}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:"Use fuzzing to automatically detect this."}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>r,x:()=>l});var s=i(6540);const t={},a=s.createContext(t);function r(e){const n=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),s.createElement(a.Provider,{value:n},e.children)}}}]);